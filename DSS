import hashlib

# Generated with OpenSSL
private_key = 0x009599bd39a52b559aadc6e937a55a5272b9374a27a4e284ec7e167e9b100c5b9445dd002989d1126fc6f9892963f5dc019e31590c5cbb8245887e4be42363fc548365ff0d942a86bf27081e3c7111f430196e3928b2221618bbde721d2f29377e470ff560da5d1ae58b2dc42ccc662d10b1725a2c6d9659c71c8115eb9910c12299c95f995281001bdbb71f6dbea5aadab972a134bbe8bf29f359816db14d593402b3dfaa45f0d05c05d882a1ff0f9587a3cb577274491f7775924ef8768a6c8462a02d89044a80453500616bed36e62562224e6b884f792f9df629678c25bf01be08e422b72e11d5c92b8a4ba97d8beae5f7624dae137776d9041dcfd116f7927303d61677ada0d17b41fedaab04d75a544b10b99906b52dd686022778b7e75ed375ce31825c0b2c616073914e582b5309dd70dd31f947a6da0d4ddd525f82d81e7a982f5dbe70afdfe629d2d167b8b9f288dee401d59c7c750530bd83754e5b9f2dc9ce2e3238834e23ef22f10db0471473c629253f8210634582e0165c5e4b46076be94c6ca59f066ef1ed0ac1d39c8c6b9ab4ce2a8fb79ccbdf15bc5da67d20106e30c1d79fb2afe9626d4264cce8069369b5f5405bc2893f54052fa44713d7869c1db3d0bd1c03e485dd1e81417e74a5f8a6e316dd5aa9e4e048dc716ae1809509178fc905fc50fef0cbfa552a01b6fea0d8906a0ce8fa276b6bc8f571d1
public_modulo = 0x00e85d35a47f2684f4fd85a7946e8844b622bdae7975b47647c8016fa2506631a235aa89923e75a82d199fad80ef6227b995cb10a58c74887221012deb57c4e11ef409de3715e73d3a765ad25da638434924ddc8d4910c2c16df89120472ed766ab38df69ce585bdbce28ba9d006224092932918d4eef7ce2f568e59fe38e3699a1ce1392e7fef6a7c1c1f154d1a4478b73518a93f4376d9e0bb92175147e4024a1dd3624a2ce44fa195513e2e0c5cc88d97afb0943550ec48fb94e7a3854401fb9a25a458028b990cbc9a5720862ce4bc53f7e5c6ca656db9e1d201b58d7577df7637a961cfbbe862b205244a0b0049a2680dee94d7daa8da3a7b4d8cfbb58c156f7d2cb059047e3ccad47ebf5e9bb850efca7f3138f9486cd5ef1b94f03dabadcd1d964490e1963bfa8e23e17105058cc001951b5ca752124ca8f8349ef6332c33ac364c0f51eb5599f52133c3238c8d0b9ca299781798b351d3af621770181fc37c11b60a6c7ac531794d408931f6a76835839c4071bc4e36ec1944788d803990b139a9877190629b6fc7dc815049be2a5e2d5266feb88f3208391f9c77a06e88fd6190a0d1e598457ca49c5ab6312d32173c97328818a34178aabe45057589ee5a191191ace141923e65473173c42b3f7434fbdce0e1382f4c344559b33e272493c7b3e129231c3175633b05483f728394bad8c0a0d28e633881faeffc8f3f

public_exponent = 65537

def sign(message):
    #Digest the message
    messageDigest = long(hashlib.sha224(message).hexdigest(), 16);
    print 'Message Digest:', messageDigest

    #get the signature on the message hash
    digitalSignature =pow(messageDigest, private_key, public_modulo) # optimized modular exponentiation
    print 'Digital Signature:', digitalSignature
    return digitalSignature

def verify(message, signature):
    #Digest the message
    messageDigest = long(hashlib.sha224(message).hexdigest(), 16)
    print 'Message Digest:', messageDigest

    #Generate the message hash from the signature
    computedMessageDigest = pow(signature, public_exponent, public_modulo)
    print 'Computed Message Digest (From Signature)', computedMessageDigest

    #Verify that the two signatures match
    if (messageDigest == computedMessageDigest):
        return True
    return False
